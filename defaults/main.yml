---
proxy_env: {}
traefik_version: 2.4.11
traefik_config_dir: /etc/traefik
traefik_log_dir: /var/log/traefik
traefik_binary_install_dir: /usr/local/bin
traefik_system_user: "{{ traefik_user | default('traefik') }}"
traefik_system_group: "{{ traefik_group | default('traefik') }}"
traefik_log_to_file: true
traefik_log_level: warn
traefik_log_format: json
traefik_limit_nofile: 8192
traefik_default_domain: "{{ ansible_domain }}"
traefik_cloudflare_enable: false
traefik_cloudflare_email: "dummy@yummi.com"
traefik_cloudflare_api_key: "dummy"
traefik_config_flags_extra: {}
traefik_config:
  global:
    checkNewVersion: true
    sendAnonymousUsage: true
  serversTransport:
    insecureSkipVerify: true
  api:
    insecure: true
    dashboard: true
  entryPoints:
    web:
      address: ":80"
    websecure:
      address: ":443"
      forwardedHeaders:
        trustedIPs: "173.245.48.0/20,103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,141.101.64.0/18,108.162.192.0/18,190.93.240.0/20,188.114.96.0/20,197.234.240.0/22,198.41.128.0/17,162.158.0.0/15,104.16.0.0/12,172.64.0.0/13,131.0.72.0/22"
    traefik:
      address: ":8080"
    metrics:
      address: ":8082"
    https:
      http:
        tls:
          certresolver: "dns-cloudflare"
          domains:
            name: "{{ traefik_default_domain }}"
            sans: "*.{{ traefik_default_domain }}"
  metrics:
    prometheus:
      #addEntryPointsLabels: true
      #addRoutersLabels: true
      #addServicesLabels: true
      entryPoint: "metrics"
  providers:
    file:
      directory: "{{ traefik_config_dir }}/rules"
      watch: true
  certificatesResolvers:
    dns-cloudflare:
      acme:
        # caServer: https://acme-staging-v02.api.letsencrypt.org/directory # ENABLE FOR TESTING
        email: "{{ traefik_cloudflare_email }}"
        storage: "{{ traefik_config_dir }}/acme/acme.json"
        dnschallenge:
          provider: "cloudflare"
          resolvers: "1.1.1.1:53,1.0.0.1:53"
          delayBeforeCheck: 90